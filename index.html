<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<title>×¡×™×›×•× ×©×™×—×”</title>
<style>
body{direction:rtl;font-family:Arial;background:#f5f5f5;padding:20px}
.box{background:#fff;max-width:900px;margin:auto;padding:20px;border-radius:10px}
label{font-weight:bold;display:block;margin-bottom:6px}
input,select,button{width:100%;padding:10px;font-size:16px;margin-bottom:12px;box-sizing:border-box}
button{cursor:pointer}
pre{background:#eee;padding:12px;white-space:pre-wrap;border-radius:8px}
.secondary{background:#eee}
</style>
</head>
<body>

<div class="box">
  <h2 id="title">×¡×™×›×•× ×©×™×—×”</h2>
  <div id="step"></div>
  <button id="nextBtn">×”××©×š</button>

  <pre id="output" style="display:none"></pre>
  <button id="copyBtn" style="display:none">ğŸ“‹ ×”×¢×ª×§</button>
  <button id="resetBtn" class="secondary" style="display:none">ğŸ” ×¡×™×•×</button>
</div>

<script>
/* ========= ×§×‘×•×¢×™× ========= */

const ACTIONS = ["× ×™×•×“","×”×©××¨×”","×¤×ª×™×—×ª ×§×•×¤×”","×¤×¨×˜"];

const INVESTMENT_COMPANIES = [
 "×”×¨××œ","×›×œ×œ","×”×¤× ×™×§×¡","××’×“×œ","××•×¨",
 "××œ×˜×©×•×œ×¨ ×©×—×","×× ×œ×™×¡×˜","×™×œ×™×Ÿ ×œ×¤×™×“×•×ª","××™× ×¤×™× ×™×˜×™","××™×˜×‘","×× ×•×¨×”"
];

const INSURANCE_COMPANIES = [
 "×”×¨××œ","××’×“×œ","×× ×•×¨×”","×”×¤× ×™×§×¡","×”×›×©×¨×”","×‘×™×˜×•×— ×™×©×™×¨","×›×œ×œ","××™×™×œ×•×Ÿ"
];

const FUND_TYPES = [
 "×§×¨×Ÿ ×¤× ×¡×™×”",
 "×§×¨×Ÿ ×”×©×ª×œ××•×ª",
 "×§×•×¤×ª ×’××œ",
 "×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”",
 "×¤×•×œ×™×¡×ª ×—×™×¡×›×•×Ÿ"
];

const EMP_STATUS = ["×©×›×™×¨×”","×¢×¦×××™×ª","×›×œ×•×"];

const TRACKS = [
 "×× ×™×•×ª","Snp500","××©×•×œ×‘ ×¡×—×™×¨","×¢×•×§×‘ ××“×“×™× ×’××™×©",
 "×× ×™×•×ª ×¡×—×™×¨","×¢×•×§×‘ ××“×“×™ ×× ×™×•×ª",
 "50% ×× ×™×•×ª 50% snp500",
 "×”×©×œ×•×© ×”×§×“×•×©","×—×¦×™ ×—×¦×™ ×× ×œ×™×¡×˜"
];

// ×“××™ × ×™×”×•×œ ×œ×¤×™ ×¡×•×’ ××•×¦×¨
const FUND_FEES = ["0.6%","0.7%","0.8%"];  // ×”×©×ª×œ××•×ª / ×’××œ / ×’××œ ×œ×”×©×§×¢×” / ×¤×•×œ×™×¡×ª ×—×™×¡×›×•×Ÿ
const PENSION_FEES = [
 "0.1% ××¦×‘×™×¨×” ×•×¢×•×“ 1.5% ××”×¤×§×“×”",
 "0.15% ××¦×‘×™×¨×” ×•×¢×•×“ 1.5% ××”×¤×§×“×”"
];

const PRIVATE_POLICIES = [
 "×¤×•×œ×™×¡×ª ××©×›× ×ª×",
 "×¤×•×œ×™×¡×ª ×—×™×™×",
 "×¤×•×œ×™×¡×ª ×—×™×™× ××©×•×¢×‘×“×ª",
 "×‘×™×˜×•×— ×‘×¨×™××•×ª",
 "×‘×™×˜×•×— ×‘×¨×™××•×ª ×•××—×œ×•×ª ×§×©×•×ª"
];

const PRIVATE_ACTIONS = ["×œ×‘×˜×œ","×œ×”×©××™×¨","×œ×”×¤×™×§ ×—×“×©","××™× ×•×™ ×¡×•×›×Ÿ"];

const KGI_PAY_OPTIONS = ["××™×Ÿ","×”×•×¨××ª ×§×‘×¢","×”×¢×‘×¨×” ×—×“ ×¤×¢××™×ª"];

/* ========= ××¦×‘ ========= */

let total = 0;
let current = 1;
let data = {};
let results = [];
let flow = [];
let flowIndex = 0;

// ×—×“×©: ××¦×‘ â€“ ×¡×™×›×•× ××• ×”××œ×¦×•×ª + ×¡×™×‘×•×ª
let summaryMode = "×¡×™×›×•×";   // "×¡×™×›×•×" ××• "×”××œ×¦×•×ª"
let reasonsText = "";

/* ========= ×”×ª×—×œ×” ========= */

// ×©××œ×” 1: ×¡×™×›×•× ××• ×”××œ×¦×•×ª
askSelect("×”×× ×–×” ×¡×™×›×•× ×©×œ ×”×“×‘×¨×™× ××• ×”××œ×¦×•×ª?","summaryModeChoice",["×¡×™×›×•× ×”×“×‘×¨×™×","×”××œ×¦×•×ª"], ()=>{
  summaryMode = (data.summaryModeChoice === "×”××œ×¦×•×ª") ? "×”××œ×¦×•×ª" : "×¡×™×›×•×";
  // ×©××œ×” 2: ×›××” ×¤×¢×•×œ×•×ª
  askInput("×›××” ×¤×¢×•×œ×•×ª ×¦×¨×™×š ×œ×¨×©×•×?","count",true);
});

/* ========= UI ========= */

function updateTitle(){
  title.textContent = total>1 ? `×¤×¢×•×œ×” ${current} ××ª×•×š ${total}` : "×¡×™×›×•× ×©×™×—×”";
}

function askInput(label,key,isFirst=false,done){
  updateTitle();
  step.innerHTML = `<label>${label}</label><input id="value">`;
  nextBtn.onclick = ()=>{
    const v = value.value.trim();
    if(!v) return alert("×™×© ×œ××œ×");
    if(isFirst){
      total = parseInt(v,10);
      if(!Number.isFinite(total) || total<=0) return alert("××¡×¤×¨ ×œ× ×ª×§×™×Ÿ");
      data = {};
      chooseAction();
      return;
    }
    data[key]=v;
    done ? done() : nextInFlow();
  };
}

// select ×œ×•×’×™ (×‘×œ×™ "××—×¨")
function askSelect(label,key,options,done){
  updateTitle();
  step.innerHTML = `<label>${label}</label>
  <select id="value">
    ${options.map(o=>`<option>${o}</option>`).join("")}
  </select>`;
  nextBtn.onclick = ()=>{
    data[key]=value.value;
    done ? done() : nextInFlow();
  };
}

// select ×¢× "××—×¨" + ××œ×œ ×—×•×¤×©×™
function askSelectWithOther(label,key,options,done){
  updateTitle();
  const allOptions = options.concat(["××—×¨"]);
  step.innerHTML = `
    <label>${label}</label>
    <select id="value">
      ${allOptions.map(o=>`<option>${o}</option>`).join("")}
    </select>
    <div id="otherBox" style="display:none"></div>
  `;
  const sel = document.getElementById("value");
  const otherBox = document.getElementById("otherBox");

  function refreshOther(){
    if(sel.value === "××—×¨"){
      otherBox.style.display = "block";
      otherBox.innerHTML = `<label>××œ×œ ×—×•×¤×©×™</label><input id="otherValue">`;
    }else{
      otherBox.style.display = "none";
      otherBox.innerHTML = "";
    }
  }
  sel.onchange = refreshOther;
  refreshOther();

  nextBtn.onclick = ()=>{
    if(sel.value === "××—×¨"){
      const ov = document.getElementById("otherValue");
      const val = (ov?.value || "").trim();
      if(!val) return alert("×™×© ×œ××œ× ××œ×œ");
      data[key]=val;
    }else{
      data[key]=sel.value;
    }
    done ? done() : nextInFlow();
  };
}

/* ========= ×–×¨×™××” ========= */

function chooseAction(){
  askSelect("××” ×¡×•×’ ×”×¤×¢×•×œ×”?","action",ACTIONS,()=>{
    buildFlow();
    nextInFlow();
  });
}

function nextInFlow(){
  if(flowIndex < flow.length){
    flow[flowIndex++]();
  }
}

function buildFlow(){
  flow=[]; flowIndex=0;

  /* ---- × ×™×•×“ ---- */
  if(data.action==="× ×™×•×“"){
    flow=[
      ()=>askSelectWithOther("××” ×©× ×”×—×‘×¨×” ×”× ×•×›×—×™×ª?","company",INVESTMENT_COMPANIES),
      ()=>askSelectWithOther("××” ×¡×•×’ ×”×§×•×¤×”?","fundType",FUND_TYPES),
      ()=>{
        if(["×§×¨×Ÿ ×¤× ×¡×™×”","×§×¨×Ÿ ×”×©×ª×œ××•×ª","×§×•×¤×ª ×’××œ"].includes(data.fundType)){
          askSelect("×”×× ×©×›×™×¨×” / ×¢×¦×××™×ª / ×›×œ×•×?","empStatus",EMP_STATUS);
        } else nextInFlow();
      },
      ()=>{
        if(data.empStatus==="×©×›×™×¨×”"){
          askInput("××” ×©× ×”××¢×¡×™×§?","employer");
        } else if(data.empStatus==="×¢×¦×××™×ª"){
          askInput("×›××” ×œ×”×¤×§×™×“?","selfAmount");
        } else nextInFlow();
      },
      ()=>askInput("××” ××¡×¤×¨ ×”×§×•×¤×”?","fundNumber"),
      ()=>askSelectWithOther("×œ××™×–×• ×—×‘×¨×” ×œ× ×™×™×“?","targetCompany",INVESTMENT_COMPANIES),
      ()=>askSelectWithOther("××” ××¡×œ×•×œ ×”×”×©×§×¢×”?","investment",TRACKS),
      ()=>askFees(save)
    ];
  }

  /* ---- ×”×©××¨×” ---- */
  if(data.action==="×”×©××¨×”"){
    flow=[
      ()=>askSelectWithOther("××” ×©× ×”×—×‘×¨×”?","company",INVESTMENT_COMPANIES),
      ()=>askSelectWithOther("××” ×¡×•×’ ×”×§×•×¤×”?","fundType",FUND_TYPES),
      ()=>{
        if(["×§×¨×Ÿ ×¤× ×¡×™×”","×§×¨×Ÿ ×”×©×ª×œ××•×ª","×§×•×¤×ª ×’××œ"].includes(data.fundType)){
          askSelect("×”×× ×©×›×™×¨×” / ×¢×¦×××™×ª / ×›×œ×•×?","empStatus",EMP_STATUS);
        } else nextInFlow();
      },
      ()=>{
        if(data.empStatus==="×©×›×™×¨×”"){
          askInput("××” ×©× ×”××¢×¡×™×§?","employer");
        } else if(data.empStatus==="×¢×¦×××™×ª"){
          askInput("×›××” ×œ×”×¤×§×™×“?","selfAmount");
        } else nextInFlow();
      },
      ()=>askInput("××” ××¡×¤×¨ ×”×§×•×¤×”?","fundNumber"),
      ()=>askSelect("××” ×¡×•×’ ×”×¤×¢×•×œ×”?","stayAction",["×©×™× ×•×™ ××¡×œ×•×œ ×”×©×§×¢×”","××™× ×•×™ ×¡×•×›×Ÿ","×œ×œ× ×©×™× ×•×™"],()=>{
        if(data.stayAction==="×©×™× ×•×™ ××¡×œ×•×œ ×”×©×§×¢×”") nextInFlow();
        else save();
      }),
      ()=>askSelectWithOther("××” ×”××¡×œ×•×œ ×”× ×•×›×—×™?","currentInvestment",TRACKS),
      ()=>askSelectWithOther("×œ××™×–×” ××¡×œ×•×œ ×™×¢×‘×•×¨?","futureInvestment",TRACKS,save)
    ];
  }

  /* ---- ×¤×ª×™×—×ª ×§×•×¤×” ---- */
  if(data.action==="×¤×ª×™×—×ª ×§×•×¤×”"){
    flow=[
      ()=>askSelectWithOther("××” ×¡×•×’ ×”××•×¦×¨?","fundType",FUND_TYPES),
      ()=>{
        if(["×§×¨×Ÿ ×¤× ×¡×™×”","×§×¨×Ÿ ×”×©×ª×œ××•×ª","×§×•×¤×ª ×’××œ"].includes(data.fundType)){
          askSelect("×”×× ×©×›×™×¨×” / ×¢×¦×××™×ª / ×›×œ×•×?","empStatus",EMP_STATUS);
        } else nextInFlow();
      },
      ()=>{
        if(data.empStatus==="×©×›×™×¨×”"){
          askInput("××” ×©× ×”××¢×¡×™×§?","employer");
        } else if(data.empStatus==="×¢×¦×××™×ª"){
          askInput("×›××” ×œ×”×¤×§×™×“?","selfAmount");
        } else nextInFlow();
      },
      ()=>askSelectWithOther("××” ×©× ×”×—×‘×¨×”?","company",INVESTMENT_COMPANIES),
      ()=>askSelectWithOther("××” ××¡×œ×•×œ ×”×”×©×§×¢×”?","investment",TRACKS),
      ()=>askFees(()=>{
        if(data.fundType==="×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”"){
          nextInFlow();
        } else {
          save();
        }
      }),
      ()=>{
        if(data.fundType==="×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”"){
          askSelect("×‘×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”: ×”×× ×™×© ×”×•×¨××ª ×§×‘×¢ / ×”×¢×‘×¨×” ×—×“ ×¤×¢××™×ª / ×›×œ×•×?","kgiPayType",KGI_PAY_OPTIONS,()=>{
            if(data.kgiPayType==="×”×•×¨××ª ×§×‘×¢"){
              askInput("××” ×”×¡×›×•× (×œ×“×•×’××” 1000)?","kgiAmount",false,save);
            } else if(data.kgiPayType==="×”×¢×‘×¨×” ×—×“ ×¤×¢××™×ª"){
              askInput("××” ×”×¡×›×•× (×œ×“×•×’××” 10000)?","kgiAmount",false,save);
            } else {
              save();
            }
          });
        } else {
          save();
        }
      }
    ];
  }

  /* ---- ×¤×¨×˜ ---- */
  if(data.action==="×¤×¨×˜"){
    flow=[
      ()=>askSelectWithOther("××” ×¡×•×’ ×”×¤×•×œ×™×¡×”?","policyType",PRIVATE_POLICIES),
      ()=>{
        // ×× ×–×• ×¤×•×œ×™×¡×” ×¢× ×¡×›×•× ×‘×™×˜×•×— â€“ ×œ×©××•×œ
        if(["×¤×•×œ×™×¡×ª ×—×™×™×","×‘×™×˜×•×— ×‘×¨×™××•×ª","×‘×™×˜×•×— ×‘×¨×™××•×ª ×•××—×œ×•×ª ×§×©×•×ª"].includes(data.policyType)){
          askInput("××”×• ×¡×›×•× ×”×‘×™×˜×•×—?","insuranceSum",false,nextInFlow);
        } else {
          nextInFlow();
        }
      },
      ()=>askSelect("××” ×œ×‘×¦×¢ ×‘×¤×•×œ×™×¡×”?","policyAction",PRIVATE_ACTIONS),
      ()=>askSelectWithOther("××” ×©× ×—×‘×¨×ª ×”×‘×™×˜×•×—?","company",INSURANCE_COMPANIES),
      ()=>{
        if(data.policyAction==="×œ×”×¤×™×§ ×—×“×©"){
          askInput("××” ×”×¤×¨××™×” ×”×—×•×“×©×™×ª?","monthlyPremium",false,save);
        } else {
          askInput("××” ××¡×¤×¨ ×”×¤×•×œ×™×¡×”?","policyNumber",false,save);
        }
      }
    ];
  }
}

/* ========= ×“××™ × ×™×”×•×œ ========= */

function askFees(done){
  const label = "××” ×“××™ ×”× ×™×”×•×œ?";
  if(data.fundType === "×§×¨×Ÿ ×¤× ×¡×™×”"){
    askSelectWithOther(label,"fees",PENSION_FEES,done);
  }
  else if(["×§×¨×Ÿ ×”×©×ª×œ××•×ª","×§×•×¤×ª ×’××œ","×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”","×¤×•×œ×™×¡×ª ×—×™×¡×›×•×Ÿ"].includes(data.fundType)){
    askSelectWithOther(label,"fees",FUND_FEES,done);
  }
  else{
    askSelectWithOther(label,"fees",[],done);
  }
}

/* ========= ×¢×–×¨×™× ========= */

function normalizeTrack(t){
  if(t==="×”×©×œ×•×© ×”×§×“×•×©") return "33% ××©×•×œ×‘ ×¡×—×™×¨ 33% ××“×“×™ ×× ×™×•×ª 34% snp500";
  if(t==="×—×¦×™ ×—×¦×™ ×× ×œ×™×¡×˜") return "50% ×¢×•×§×‘ ××“×“×™× ×’××™×© 50% snp500";
  return t;
}

// ×˜×§×¡×˜ ×××¦×¢×™ â€“ ×©×›×™×¨×” / ×¢×¦×××™×ª
function empTextMiddle(){
  if(data.empStatus==="×©×›×™×¨×”") return ` ×©×›×™×¨×” ×ª×—×ª ×”××¢×¡×™×§ ${data.employer}`;
  if(data.empStatus==="×¢×¦×××™×ª") return ` ×¢×¦×××™×ª`;
  return "";
}

// ×˜×§×¡×˜ ×¡×•×£ â€“ ×”×¤×§×“×” ×—×•×“×©×™×ª ×œ×¢×¦×××™
function selfDepositSuffix(){
  if(data.empStatus==="×¢×¦×××™×ª" && data.selfAmount){
    return ` ×¢× ×”×¤×§×“×” ×—×•×“×©×™×ª ×©×œ ${data.selfAmount} â‚ª`;
  }
  return "";
}

// ×”×× ×¡×•×’ ×”×¤×•×œ×™×¡×” ×“×•×¨×© ×¡×›×•× ×‘×™×˜×•×—
function needInsuranceSum(){
  return ["×¤×•×œ×™×¡×ª ×—×™×™×","×‘×™×˜×•×— ×‘×¨×™××•×ª","×‘×™×˜×•×— ×‘×¨×™××•×ª ×•××—×œ×•×ª ×§×©×•×ª"].includes(data.policyType);
}

// ×˜×§×¡×˜ ×¡×›×•× ×‘×™×˜×•×—
function insuranceSumText(){
  if(needInsuranceSum() && data.insuranceSum){
    return ` ×‘×¡×›×•× ×‘×™×˜×•×— ×©×œ ${data.insuranceSum} â‚ª`;
  }
  return "";
}

/* ========= ×©××™×¨×” ========= */

function save(){
  let prefix = total>1 ? `${current}. ` : "";
  let line = prefix;

  /* ---- × ×™×•×“ ---- */
  if(data.action==="× ×™×•×“"){
    line += `${data.company} ${data.fundType}${empTextMiddle()} ××¡×¤×¨ ×§×•×¤×” ${data.fundNumber}- ×ª× ×•×™×“ ×œ×—×‘×¨×ª ${data.targetCompany} ×›××©×¨ ×”×›×¡×£ ×™×•×©×§×¢ ×‘××¡×œ×•×œ ×”×©×§×¢×” ${normalizeTrack(data.investment)} ×‘×“××™ × ×™×”×•×œ ${data.fees}`;
    line += selfDepositSuffix();
  }

  /* ---- ×”×©××¨×” ---- */
  if(data.action==="×”×©××¨×”"){
    if(data.stayAction==="×œ×œ× ×©×™× ×•×™"){
      line += `${data.company} ${data.fundType}${empTextMiddle()} ××¡×¤×¨ ×§×•×¤×” ${data.fundNumber} â€“ ×ª×™×©××¨ ×œ×œ× ×©×™× ×•×™`;
    } else if(data.stayAction==="××™× ×•×™ ×¡×•×›×Ÿ"){
      line += `${data.company} ${data.fundType}${empTextMiddle()} ××¡×¤×¨ ×§×•×¤×” ${data.fundNumber} â€“ ××™× ×•×™ ×¡×•×›×Ÿ`;
    } else {
      line += `${data.company} ${data.fundType}${empTextMiddle()} ××¡×¤×¨ ×§×•×¤×” ${data.fundNumber} â€“ ×ª×™×©××¨ ×‘××•×ª×” ×—×‘×¨×” ×›××©×¨ ×™×ª×‘×¦×¢ ×©×™× ×•×™ ××¡×œ×•×œ ×${normalizeTrack(data.currentInvestment)} ×œ${normalizeTrack(data.futureInvestment)}`;
    }
    line += selfDepositSuffix();
  }

  /* ---- ×¤×ª×™×—×ª ×§×•×¤×” ---- */
  if(data.action==="×¤×ª×™×—×ª ×§×•×¤×”"){
    line += `×¤×ª×™×—×ª ${data.fundType}${empTextMiddle()} ×‘×—×‘×¨×ª ${data.company} ×›××©×¨ ×”×›×¡×£ ×™×•×©×§×¢ ×‘××¡×œ×•×œ ×”×©×§×¢×” ${normalizeTrack(data.investment)} ×‘×“××™ × ×™×”×•×œ ${data.fees}`;

    if(data.fundType==="×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”" && data.kgiPayType && data.kgiPayType!=="××™×Ÿ"){
      const amt = (data.kgiAmount || "").trim();
      if(data.kgiPayType==="×”×•×¨××ª ×§×‘×¢"){
        line += ` ×¢× ×”×•×¨××ª ×§×‘×¢ ×‘×¡×›×•× ×©×œ ${amt} â‚ª ×‘×—×•×“×©`;
      } else if(data.kgiPayType==="×”×¢×‘×¨×” ×—×“ ×¤×¢××™×ª"){
        line += ` ×¢× ×”×¢×‘×¨×” ×—×“ ×¤×¢××™×ª ×‘×¡×›×•× ×©×œ ${amt} â‚ª`;
      }
    }

    if(data.fundType!=="×§×•×¤×ª ×’××œ ×œ×”×©×§×¢×”"){
      line += selfDepositSuffix();
    }
  }

  /* ---- ×¤×¨×˜ ---- */
  if(data.action==="×¤×¨×˜"){
    if(data.policyAction==="××™× ×•×™ ×¡×•×›×Ÿ"){
      line += `${data.policyType} ×‘×—×‘×¨×ª ${data.company} ××¡×¤×¨ ×¤×•×œ×™×¡×” ${data.policyNumber}- ×™×ª×‘×¦×¢ ××™× ×•×™ ×¡×•×›×Ÿ`;
      line += insuranceSumText();
    } else if(data.policyAction==="×œ×‘×˜×œ"){
      line += `${data.policyType} ×‘×—×‘×¨×ª ${data.company} ××¡×¤×¨ ×¤×•×œ×™×¡×” ${data.policyNumber}- ×ª×‘×•×˜×œ`;
      line += insuranceSumText();
    } else if(data.policyAction==="×œ×”×©××™×¨"){
      line += `${data.policyType} ×‘×—×‘×¨×ª ${data.company} ××¡×¤×¨ ×¤×•×œ×™×¡×” ${data.policyNumber}- ×ª×™×©××¨`;
      line += insuranceSumText();
    } else {
      line += `×ª×•×¤×§ ×¤×•×œ×™×¡×” ×—×“×©×” ×©×œ ${data.policyType} ×‘×—×‘×¨×ª ${data.company} ×‘×¤×¨××™×” ×—×•×“×©×™×ª ×©×œ ${data.monthlyPremium} â‚ª`;
      line += insuranceSumText();
    }
  }

  results.push(line);

  if(current < total){
    current++;
    data={};
    flow=[]; flowIndex=0;
    chooseAction();
  } else {
    // ×× ×–×” "×”××œ×¦×•×ª" â€“ ×§×•×“× ×œ×©××•×œ ×¡×™×‘×•×ª
    if(summaryMode === "×”××œ×¦×•×ª" && !reasonsText){
      askInput("×¨×©×•× ××ª ×›×œ ×”×¡×™×‘×•×ª ×œ×”××œ×¦×•×ª","reasons",false, ()=>{
        reasonsText = data.reasons || "";
        finish();
      });
    } else {
      finish();
    }
  }
}

/* ========= ×¡×™×•× ========= */

function finish(){
  let header;
  if(summaryMode === "×”××œ×¦×•×ª"){
    header = `× ×××¨×• ×”×”××œ×¦×•×ª ×”×‘××•×ª:\n\n`;
  } else {
    header = `×‘×”××©×š ×œ×©×™×—×ª× ×•\n×¡×•×›× ×¢×œ ×”×“×‘×¨×™× ×”×‘××™×:\n\n`;
  }

  let text = header + results.join("\n");

  if(summaryMode === "×”××œ×¦×•×ª" && reasonsText){
    text += `\n\n×”×¡×™×‘×•×ª ×œ×”××œ×¦×•×ª:\n${reasonsText}`;
  }

  output.textContent = text;
  step.style.display="none";
  nextBtn.style.display="none";
  output.style.display="block";
  copyBtn.style.display="block";
  resetBtn.style.display="block";
  copyBtn.onclick = ()=>navigator.clipboard.writeText(output.textContent);
  resetBtn.onclick = ()=>location.reload();
}
</script>

</body>
</html>